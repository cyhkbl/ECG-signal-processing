# ECG 信号处理项目 (ECG Signal Processing)

> 一个基于 Python 的心电信号（ECG）处理与分析工具集。
> 
> 功能：从 MIT-BIH 心律失常数据库中获取数据，进行信号滤波、R 波提取、心率计算以及异常检测。

## 数据交互 (`dataloader.py`)

*   使用 `wfdb` 库载入 MIT-BIH 数据库中的 ECG 信号。
*   提供信号 (`signal`) 和采样率 (`fs`) 的读取功能。

## 可视化 (`draw.py`)

*   基于 `matplotlib` 实现信号的可视化。
*   绘制心电图波形，并将时间单位转换为秒。

## 滤波 (`filter.py`)

*   **带通滤波**：去除 0.5Hz 以下的基线漂移和 40Hz 以上的高频噪声。
*   **陷波滤波**：针对性去除 50Hz 的工频干扰。

## R波提取 (`rwave.py`)

*   应用平方能量增强法突出 R 波。
*   利用 `scipy.signal.find_peaks` 实现 R 波峰值的自动定位与标注。

## 心率分析 (`beat.py`)

*   根据 R 波位置计算 RR 间期（RR Interval）。
*   实时计算瞬时心率（BPM）及全段平均心率。

## 异常心律检测 (`abnormal.py`)
*   基于心率数据识别心律异常。
*   统计并报告心动过速（>100 BPM）和心动过缓（<60 BPM）的频次。

## 环境配置

### 1. 安装依赖
本项目依赖于 `numpy`, `scipy`, `matplotlib` 和 `wfdb`。可以通过以下命令安装：

```bash
pip install -r requirements.txt
```

### 2. 数据准备
程序默认读取 `mitdb/100` 数据。请确保您的工作目录下存在相应的 `mitdb` 文件夹，或通过 `wfdb` 自动下载。

## 使用方法

运行主程序开始分析：

```bash
python main.py
```

## 当前开发状态
*   [x] 信号基础滤波与去噪
*   [x] R 波峰值提取
*   [x] 基础心率计算与心律异常统计
*   [ ] 深度学习模型异常分类（开发中）
## 生物医学工程 (BME) 专业优化方向

基于当前的系统架构，从生物医学工程的专业角度出发，建议在以下维度进行深度优化：

1.  **全波段特征定界 (Waveform Delinitation)**：
    *   目前仅实现了 R 波检测。建议引入 **Pan-Tompkins 算法** 的改进版或基于相位的提取方法，实现 **P 波、QRS 复合波、T 波** 的起始与终止点自动定位，这对于诊断房室传导阻滞及 QT 间期延长至关重要。

2.  **心率变异性 (HRV) 深度分析**：
    *   目前的瞬时心率仅是基础。可增加 **时域分析** (如 SDNN, RMSSD) 和 **频域分析** (通过 FFT 或 Lomb-Scargle 周期图计算 LF/HF 比值)，用于定量评估自主神经系统的调节功能。

3.  **高级非平稳去噪**：
    *   数字滤波虽能处理固定频率，但对于非平稳的肌电干扰 (EMG) 和基线漂移效果有限。建议引入 **小波变换 (Wavelet Transform)** 或 **经验模态分解 (EMD)**，在保留 ECG 细节特征的同时实现自适应去噪。

4.  **信号质量指数 (SQI) 评估**：
    *   在临床应用中，运动伪迹常导致误报。建议增加 SQI 模块，通过特征相关性或功率谱分布自动检测并标记“不可信”信号，提高系统的鲁棒性。

5.  **搏动分类与智能诊断**：
    *   依照 AAMI 标准，将检测到的搏动分类为：正常 (N)、室性异位 (V)、室上性异位 (S) 等。可以引入轻量化的 **CNN** 或 **Random Forest** 提取形态学特征，实现自动化的异常分类。
---
*注：本项目仅供学术研究和学习参考，不可用于临床诊断。*
